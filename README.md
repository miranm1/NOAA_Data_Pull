# NOAA_Web_Scrapper
This program uses the API from National Oceanic and Atmospheric Administration to gather weather station data.  It specificlly grabs a daily precipitation values from a  start date to end date. To use the program simply put in the dates for start and end date in the cells B3 and B4. Finally just press the button and wait for the spread sheet to update with values going down the columns.  Precipitation values will go down under the labeled weather station name and print its corresponding date to the left. 
![alt text](https://github.com/miranm1/NOAA_Web_Scrapper/blob/master/noaa1.PNG)
![alt text](https://github.com/miranm1/NOAA_Web_Scrapper/blob/master/noaa2.PNG)
![alt text](https://github.com/miranm1/NOAA_Web_Scrapper/blob/master/noaa3.PNG)
![alt text](https://github.com/miranm1/NOAA_Web_Scrapper/blob/master/noaa4.PNG)
# How it works:
On the Excel spreadsheet I have placed locations for the data to be read into the program. In "B3" is where the user will put in the start date for data collection and "B4" is the end date. The next area used to input data is row 11 and the column is incremented by two to get to the next item. So the starting point is "B11" and the next will be "D11". What is placed in this location is the weather station id used in the API for the website. These 3 parts of input are need to build the URL for the NOAA website API. After the URL is built in the program it will request data from the NOAA website. The NOAA API requires a token that can be acquired from their website. ( https://www.ncdc.noaa.gov/cdo-web/token ) The data is received in JSON format so the data will need to be parsed through using a JsonConverter ( https://github.com/VBA-tools/VBA-JSON ). After the data is converted, an array will be created with the size of the number of items in the json. For this case it is "results" which holds the date and precipitation values. The values are placed in the array using a For Each statement. When this is completed it will now write the data into the spreadsheet going down the column. When this is finished it will move to the next column of data.
